(()=>{var e={};e.id=16,e.ids=[16],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},2412:e=>{"use strict";e.exports=require("assert")},4735:e=>{"use strict";e.exports=require("events")},9021:e=>{"use strict";e.exports=require("fs")},1630:e=>{"use strict";e.exports=require("http")},5591:e=>{"use strict";e.exports=require("https")},1820:e=>{"use strict";e.exports=require("os")},3873:e=>{"use strict";e.exports=require("path")},7910:e=>{"use strict";e.exports=require("stream")},3997:e=>{"use strict";e.exports=require("tty")},9551:e=>{"use strict";e.exports=require("url")},8354:e=>{"use strict";e.exports=require("util")},4075:e=>{"use strict";e.exports=require("zlib")},6033:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>x,pages:()=>c,routeModule:()=>m,tree:()=>o});var r=s(260),a=s(8203),i=s(5155),l=s.n(i),n=s(7292),d={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>n[e]);s.d(t,d);let o=["",{children:["admin",{children:["customers",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,6295)),"/infinite-drive-v2/frontend/src/app/admin/customers/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,6038)),"/infinite-drive-v2/frontend/src/app/admin/layout.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,1354)),"/infinite-drive-v2/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,9116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,1485,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["/infinite-drive-v2/frontend/src/app/admin/customers/page.tsx"],x={require:s,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/admin/customers/page",pathname:"/admin/customers",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},3918:(e,t,s)=>{Promise.resolve().then(s.bind(s,6295))},6614:(e,t,s)=>{Promise.resolve().then(s.bind(s,7291))},7291:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});var r=s(5512),a=s(8009),i=s(5668),l=s(2149);function n(){let[e,t]=(0,a.useState)([]),[s,n]=(0,a.useState)(!0),[d,o]=(0,a.useState)(null),[c,x]=(0,a.useState)(null),[m,p]=(0,a.useState)(!1),[u,h]=(0,a.useState)(""),[f,g]=(0,a.useState)("all"),j=async()=>{n(!0),o(null);try{let e=localStorage.getItem("token"),s="https://infinitedriven.com/api",r=await i.A.get(`${s}/admin/customers`,{headers:{Authorization:`Bearer ${e}`}});t(r.data);let a=setInterval(async()=>{try{let r=await i.A.get(`${s}/admin/customers`,{headers:{Authorization:`Bearer ${e}`}});t(r.data)}catch(e){console.error("Error refreshing customers data:",e)}},3e4);return()=>clearInterval(a)}catch(e){console.error("Error fetching customers:",e),i.A.isAxiosError(e)&&e.response&&401===e.response.status?o("Authentication error. Please log in again."):i.A.isAxiosError(e)&&e.response&&e.response.status>=500?o("Server error. Please try again later."):o("Failed to fetch customers from server. Please try again later.")}finally{n(!1)}},v=e.filter(e=>{let t=e.email.toLowerCase().includes(u.toLowerCase());return("all"===f||"repeat"===f&&e.totalOrders>1||"single"===f&&1===e.totalOrders)&&t});return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"Customer Management"}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)(l.A,{onClick:()=>{p(!0);try{let t="data:text/csv;charset=utf-8,Email,Total Orders,Total Spent\n"+e.map(e=>`${e.email},${e.totalOrders},${e.totalSpent}`).join("\n"),s=encodeURI(t),r=document.createElement("a");r.setAttribute("href",s),r.setAttribute("download","customer_emails.csv"),document.body.appendChild(r),r.click(),document.body.removeChild(r)}catch(e){console.error("Error exporting emails:",e),o("Failed to export emails. Please try again.")}finally{p(!1)}},className:"bg-green-600 hover:bg-green-700",disabled:m,children:m?"Exporting...":"Export Email List"}),(0,r.jsx)(l.A,{onClick:j,className:"bg-blue-600 hover:bg-blue-700",disabled:s,children:s?"Loading...":"Refresh"})]})]}),d&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded relative",children:d}),(0,r.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsx)("input",{type:"text",placeholder:"Search by email...",className:"w-full px-4 py-2 border rounded-lg",value:u,onChange:e=>h(e.target.value)})}),(0,r.jsx)("div",{children:(0,r.jsxs)("select",{className:"px-4 py-2 border rounded-lg",value:f,onChange:e=>g(e.target.value),children:[(0,r.jsx)("option",{value:"all",children:"All Customers"}),(0,r.jsx)("option",{value:"repeat",children:"Repeat Customers"}),(0,r.jsx)("option",{value:"single",children:"One-time Customers"})]})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Total Customers"}),(0,r.jsx)("p",{className:"text-3xl font-bold",children:e.length})]}),(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Repeat Customers"}),(0,r.jsx)("p",{className:"text-3xl font-bold",children:e.filter(e=>e.totalOrders>1).length})]}),(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Total Revenue"}),(0,r.jsxs)("p",{className:"text-3xl font-bold",children:["$",e.reduce((e,t)=>e+t.totalSpent,0).toFixed(2)]})]})]}),(0,r.jsx)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Orders"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Spent"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Order"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:s?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:5,className:"px-6 py-4 text-center",children:(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500"})})})}):0===v.length?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:5,className:"px-6 py-4 text-center text-gray-500",children:"No customers found"})}):v.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0 h-10 w-10 bg-blue-100 rounded-full flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-blue-600 font-medium",children:e.email.charAt(0).toUpperCase()})}),(0,r.jsxs)("div",{className:"ml-4",children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.email}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:["ID: ",e.id]})]})]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.totalOrders}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:["$",e.totalSpent.toFixed(2)]}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.lastOrderDate).toLocaleDateString()}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,r.jsx)("button",{onClick:()=>x(e),className:"text-blue-600 hover:text-blue-900",children:"View Details"})})]},e.id))})]})}),c&&(0,r.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 w-full max-w-lg",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold",children:"Customer Details"}),(0,r.jsx)("button",{onClick:()=>x(null),className:"text-gray-500 hover:text-gray-700",children:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:"Email"}),(0,r.jsx)("p",{className:"mt-1 text-lg",children:c.email})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:"Customer ID"}),(0,r.jsx)("p",{className:"mt-1",children:c.id})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:"Purchase History"}),(0,r.jsxs)("div",{className:"mt-1 bg-gray-50 p-3 rounded",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{children:"Total Orders:"}),(0,r.jsx)("span",{className:"font-medium",children:c.totalOrders})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{children:"Total Spent:"}),(0,r.jsxs)("span",{className:"font-medium",children:["$",c.totalSpent.toFixed(2)]})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{children:"Last Order Date:"}),(0,r.jsx)("span",{className:"font-medium",children:new Date(c.lastOrderDate).toLocaleDateString()})]})]})]}),c.cryptoWallets&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:"Crypto Wallets"}),(0,r.jsx)("div",{className:"mt-1 space-y-2",children:Object.entries(c.cryptoWallets).map(([e,t])=>(0,r.jsxs)("div",{className:"bg-gray-50 p-3 rounded",children:[(0,r.jsx)("div",{className:"text-sm font-medium",children:e}),(0,r.jsx)("div",{className:"text-xs font-mono truncate",children:t})]},e))})]})]}),(0,r.jsx)("div",{className:"mt-6 flex justify-end",children:(0,r.jsx)(l.A,{onClick:()=>x(null),className:"bg-gray-500 hover:bg-gray-600",children:"Close"})})]})})]})}},2149:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});var r=s(5512);function a({children:e,className:t="",onClick:s,type:a="button",...i}){return(0,r.jsx)("button",{type:a,className:`bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition-colors ${t}`,onClick:s,...i,children:e})}},6295:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(6760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/infinite-drive-v2/frontend/src/app/admin/customers/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/infinite-drive-v2/frontend/src/app/admin/customers/page.tsx","default")}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[638,408,77,531,939],()=>s(6033));module.exports=r})();